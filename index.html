<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waitlist</title>
    <link href="https://fonts.cdnfonts.com/css/akkurat" rel="stylesheet">
    <style>
        body {
            background-color: #000FF;
            color: white;
            font-family: 'Akkurat', Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            text-align: center;
        }
        .main-img {
            position: sticky;
            top: 0;
            width: 100%;
            height: auto;
            transition: all 0.5s ease;
        }
        .hidden {
            display: none;
        }
        .dos-text::before {
            content: 'â–ˆ';
            animation: blink 1s infinite;
            margin-right: 5px;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        #waitlist-btn {
            padding: 10px;
            border: 2px solid white;
            display: inline-block;
            margin-top: 20px;
            cursor: pointer;
            user-select: none;
            position: absolute;
            transition: all 0.3s ease;
        }
        .product-img {
            width: 300px;
            height: auto;
            overflow: hidden;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <img src="https://i.ibb.co/DP0MHnjM/IMG-6365.jpg" class="main-img" id="mainImg">
    <div id="content"></div>

    <script>
        async function fetchSpreadsheetData() {
            const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT6aU1_jB0juldfdNBs-KX3XLLqOuAoZDNpg_znvr_x1ToUAariHKo2Gz-REVye58V_nenvXETUOTZk/pub?output=csv';
            const response = await fetch(url);
            const data = await response.text();
            const rows = data.split('\n').map(row => row.split(','));
            return rows;
        }

        function typeText(text, element, delay = 100) {
            let i = 0;
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                }
            }, delay);
        }

        function slowLoadImage(url, element) {
            let img = new Image();
            img.src = url;
            img.onload = function() {
                element.src = url;
                element.style.clipPath = 'inset(100% 0 0 0)';
                element.style.transition = 'clip-path 4s linear';
                setTimeout(() => element.style.clipPath = 'inset(0 0 0 0)', 100);
            };
        }

        window.onload = async () => {
            const data = await fetchSpreadsheetData();

            let content = document.getElementById('content');
            content.innerHTML = `<h2 class='dos-text'></h2>`;
            typeText('welcome to waitlist.', document.querySelector('.dos-text'));

            window.addEventListener('scroll', () => {
                const img = document.getElementById('mainImg');
                if (window.scrollY > 0) img.style.width = '100px';
                else img.style.width = '100%';
            });

            setTimeout(() => {
                content.innerHTML += `<img class='product-img' id='prodImg'>`;
                slowLoadImage(data[1][1], document.getElementById('prodImg'));

                setTimeout(() => {
                    content.innerHTML += `
                    <p>Product: ${data[0][1]}</p>
                    <p>Materials: ${data[2][1]}</p>
                    <p>Price: ${data[3][1]}</p>
                    <p>Wait: ${data[4][1]}</p>
                    <div id='waitlist-btn'>join the waitlist.</div>`;

                    const btn = document.getElementById('waitlist-btn');
                    let clickCount = 0;
                    btn.onclick = () => {
                        clickCount++;
                        if (clickCount < 3) {
                            btn.style.top = Math.random() * 80 + 'vh';
                            btn.style.left = Math.random() * 80 + 'vw';
                        } else {
                            document.body.innerHTML = '';
                            setTimeout(() => {
                                document.body.innerHTML = `<h2 class='dos-text'></h2>`;
                                let seconds = 900;
                                const countdown = setInterval(() => {
                                    document.querySelector('.dos-text').innerHTML = `You are locked out of waitlist for ${seconds} seconds`;
                                    seconds--;
                                    if (seconds < 0) clearInterval(countdown);
                                }, 1000);
                            }, 2000);
                        }
                    };
                }, 4500);
            }, 3000);
        };
    </script>
</body>
</html>
