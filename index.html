<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>WAITLIST</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
  
  <style>
    :root {
      --bg: #0000FF;
      --fg: #ffffff;
    }

    * { box-sizing: border-box; }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: "Inter", Helvetica, Arial, sans-serif;
      overflow-x: hidden;
      overscroll-behavior: none;
    }

    /* --- UTILITIES --- */
    .mono {
      font-family: "Courier New", Courier, monospace;
      text-transform: uppercase;
      letter-spacing: -0.5px;
    }

    .container {
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
    }

    /* --- CSS CLOCK --- */
    .clock-wrap {
      position: sticky;
      top: 0;
      z-index: 10;
      padding-top: 40px;
      padding-bottom: 20px;
      background: var(--bg);
      width: 100%;
      display: flex;
      justify-content: center;
      transition: transform 0.1s;
    }

    .clock {
      width: 200px;
      height: 200px;
      border: 2px solid var(--fg);
      border-radius: 50%;
      position: relative;
    }

    .hand {
      position: absolute;
      background: var(--fg);
      transform-origin: bottom center;
      left: 50%;
      bottom: 50%;
      border-radius: 2px;
      /* Ensure they stay in final position after spinning */
      animation-fill-mode: forwards; 
      animation-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1.0); /* Smooth ease-out */
    }

    .hand.hour {
      width: 2px; /* Slimmer */
      height: 50px;
      margin-left: -1px; /* Center alignment */
      /* Spin to approx 10 o'clock position (-55deg) */
      animation-name: spin-hour;
      animation-duration: 3s;
    }

    .hand.minute {
      width: 2px; /* Slimmer */
      height: 70px;
      margin-left: -1px;
      /* Spin to approx 10 minute position (60deg) */
      animation-name: spin-minute;
      animation-duration: 2.5s;
    }

    @keyframes spin-hour {
      from { transform: rotate(0deg); }
      to { transform: rotate(-55deg); }
    }

    @keyframes spin-minute {
      from { transform: rotate(0deg); }
      to { transform: rotate(60deg); }
    }

    /* --- MAIN STAGE --- */
    .stage {
      width: 100%;
      max-width: 800px; /* Increased max-width slightly for main area */
      padding: 20px;
      margin-bottom: 100px;
      text-align: center;
      z-index: 20;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Typewriter Heading */
    .heading-wrap {
      font-size: clamp(24px, 4vw, 32px);
      margin: 40px 0;
      min-height: 1.2em;
      font-weight: 600;
      display: inline-block;
    }
    
    .blinking-cursor {
      animation: blink 1s infinite step-end;
      margin-left: 2px;
    }
    @keyframes blink { 50% { opacity: 0; } }


    /* Product Image Container - CSS trick for background */
    .img-container {
      width: 100%;
      max-width: 500px;
      margin: 0 auto 40px auto;
      background-color: var(--bg); /* Ensure background behind image is blue */
      border-radius: 4px;
      overflow: hidden;
    }

    .product-img {
      width: 100%;
      height: auto;
      display: block;
      /* CSS Trick to make the grey background blue:
         1. Increase contrast to make the grey background lighter and shirt whiter.
         2. Use 'multiply' blend mode against the blue container background. 
            This tints everything blue, making the grey background match the site 
            and giving the shirt a monochromatic blue look.
      */
      filter: contrast(1.3) brightness(1.1);
      mix-blend-mode: multiply; 
    }

    /* Meta Data Table */
    .meta-data {
      text-align: center;
      border-top: 1px solid var(--fg);
      margin: 0 auto 60px auto; /* Centered horizontally */
      width: fit-content; /* Only as wide as it needs to be */
      min-width: 280px; /* Ensure it doesn't look too crushed on small screens */
    }

    .meta-row {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid var(--fg);
      padding: 12px 10px;
      font-size: 14px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.5s, transform 0.5s;
      gap: 20px; /* Minimum space between labels and values */
    }
    .meta-row.visible { opacity: 1; transform: translateY(0); }

    /* --- THE BUTTON AREA --- */
    .btn-area {
      position: relative;
      width: 100%;
      max-width: 600px;
      height: 300px; 
    }

    .waitlist-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 14px 24px;
      background: var(--fg);
      color: var(--bg);
      border: none;
      font-family: "Inter", sans-serif;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      border-radius: 4px;
      white-space: nowrap;
      transition: top 0.1s ease, left 0.1s ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    /* --- LOCKOUT SCREEN --- */
    .lockout {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: var(--fg);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      text-align: center;
    }

    .lockout-msg { font-size: 14px; margin-bottom: 10px; letter-spacing: 1px; }
    .timer { font-size: 14px; font-weight: 600; }

  </style>
</head>
<body>

  <div class="container" id="mainContainer">
    
    <div class="clock-wrap" id="clockWrap">
      <div class="clock">
        <div class="hand hour"></div>
        <div class="hand minute"></div>
      </div>
    </div>

    <main class="stage">
      <div class="heading-wrap" id="headingWrap">
        <span id="typeTarget"></span>
        </div>

      <div class="img-container">
        <img src="https://i.ibb.co/hFDSgSMb/tshirt.jpg" alt="Item" class="product-img" />
      </div>

      <div class="meta-data" id="metaData">
        </div>

      <div class="btn-area" id="btnArea">
        <button class="waitlist-btn" id="runBtn">Join the waitlist</button>
      </div>

    </main>
  </div>

  <div class="lockout" id="lockoutScreen">
    <div class="lockout-msg mono">ACCESS TEMPORARILY SUSPENDED</div>
    <div class="timer mono" id="lockoutTimer">00:00</div>
  </div>

  <script>
    /* --- CONFIG --- */
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT6aU1_jB0juldfdNBs-KX3XLLqOuAoZDNpg_znvr_x1ToUAariHKo2Gz-REVye58V_nenvXETUOTZk/pub?output=csv';

    /* --- SCROLL SHRINK EFFECT --- */
    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;
      const clock = document.getElementById('clockWrap');
      const scale = Math.max(0.5, 1 - (scrollY / 400));
      clock.style.transform = `scale(${scale})`;
    });

    /* --- TYPEWRITER --- */
    async function typeText(text) {
      const target = document.getElementById('typeTarget');
      const wrap = document.getElementById('headingWrap');
      target.textContent = '';
      
      // Type the text
      for (let i = 0; i < text.length; i++) {
        target.textContent += text.charAt(i);
        await new Promise(r => setTimeout(r, 60)); // Typing speed
      }

      // Append blinking cursor AFTER typing finishes
      const cursor = document.createElement('span');
      cursor.className = 'blinking-cursor';
      cursor.innerHTML = '|';
      wrap.appendChild(cursor);
    }

    /* --- DATA LOADING --- */
    function parseCSV(text) {
      const rows = [];
      let row = [], field = '', inQuotes = false;
      for (let i = 0; i < text.length; i++) {
        const c = text[i], n = text[i+1];
        if (c === '"') {
          if (inQuotes && n === '"') { field += '"'; i++; }
          else inQuotes = !inQuotes;
        } else if (c === ',' && !inQuotes) {
          row.push(field); field = '';
        } else if ((c === '\n' || c === '\r') && !inQuotes) {
          if (field !== '' || row.length) { row.push(field); field = ''; rows.push(row); row = []; }
          if (c === '\r' && n === '\n') i++;
        } else { field += c; }
      }
      if (field !== '' || row.length) { row.push(field); rows.push(row); }
      return rows;
    }

    async function initData() {
      try {
        const res = await fetch(CSV_URL);
        const text = await res.text();
        const rows = parseCSV(text);
        const getVal = (r) => (rows[r] && rows[r][1]) ? rows[r][1].trim() : '---';
        
        const data = [
           { label: 'ITEM', val: getVal(0) },
           { label: 'MATERIAL', val: getVal(2) },
           { label: 'PRICE', val: getVal(3) },
           { label: 'WAIT', val: getVal(4) }
        ];

        const container = document.getElementById('metaData');
        container.innerHTML = '';
        
        data.forEach((item, index) => {
          const div = document.createElement('div');
          div.className = 'meta-row mono';
          // Using span styling to ensure alignment in centered table
          div.innerHTML = `<span style="text-align:left">${item.label}</span> <span style="text-align:right">${item.val}</span>`;
          container.appendChild(div);
          setTimeout(() => div.classList.add('visible'), index * 200 + 500);
        });

      } catch (e) {
        console.error("Sheet load failed", e);
        document.getElementById('metaData').innerHTML = '<div class="meta-row visible mono">DATA CONNECTION LOST</div>';
      }
    }

    /* --- THE HAVOC BUTTON --- */
    const btn = document.getElementById('runBtn');
    const area = document.getElementById('btnArea');
    let clicks = 0;

    function moveButton(e) {
      const areaRect = area.getBoundingClientRect();
      const btnRect = btn.getBoundingClientRect();
      const maxX = areaRect.width - btnRect.width;
      const maxY = areaRect.height - btnRect.height;
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;

      btn.style.left = x + 'px';
      btn.style.top = y + 'px';
      btn.style.transform = 'translate(0,0)'; 

      clicks++;
      if (clicks > 8) triggerLockout();
    }

    btn.addEventListener('mouseover', moveButton);
    btn.addEventListener('touchstart', (e) => { e.preventDefault(); moveButton(); }, { passive: false });
    btn.addEventListener('click', (e) => { e.preventDefault(); triggerLockout(); });

    /* --- LOCKOUT --- */
    function triggerLockout() {
      const screen = document.getElementById('lockoutScreen');
      const timerEl = document.getElementById('lockoutTimer');
      screen.style.display = 'flex';
      document.getElementById('mainContainer').style.display = 'none';
      
      let timeLeft = 600;
      const tick = () => {
        timeLeft--;
        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        timerEl.textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        if(timeLeft <= 0) window.location.reload();
      };
      setInterval(tick, 1000);
      tick();
    }

    /* --- INIT --- */
    // Start typing after a brief pause
    setTimeout(() => typeText("Join the waitlist."), 800);
    initData();

  </script>
</body>
</html>
